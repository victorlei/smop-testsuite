PROGRAM mjy01a
 
! Code converted using TO_F90 by Alan Miller
! Date: 2004-06-28  Time: 12:58:11

!       =========================================================
!       Purpose: This program computes the Bessel functions
!                Jn(x) and Yn(x) ( n=0,1 ) and their derivatives
!                using subroutine JY01A
!       Input :  x   --- Argument of Jn(x) & Yn(x) ( x ò 0 )
!       Output:  BJ0 --- J0(x)
!                DJ0 --- J0'(x)
!                BJ1 --- J1(x)
!                DJ1 --- J1'(x)
!                BY0 --- Y0(x)
!                DY0 --- Y0'(x)
!                BY1 --- Y1(x)
!                DY1 --- Y1'(x)
!       Example:

!        x       J0(x)        J0'(x)       J1(x)        J1'(x)
!       ---------------------------------------------------------
!        1     .76519769   -.44005059    .44005059    .32514710
!        5    -.17759677    .32757914   -.32757914   -.11208094
!       10    -.24593576   -.04347275    .04347275   -.25028304
!       20     .16702466   -.06683312    .06683312    .16368301
!       30    -.08636798    .11875106   -.11875106   -.08240961
!       40     .00736689   -.12603832    .12603832    .00421593
!       50     .05581233    .09751183   -.09751183    .05776256

!        x       Y0(x)        Y0'(x)       Y1(x)        Y1'(x)
!      ---------------------------------------------------------
!        1     .08825696    .78121282   -.78121282    .86946979
!        5    -.30851763   -.14786314    .14786314   -.33809025
!       10     .05567117   -.24901542    .24901542    .03076962
!       20     .06264060    .16551161   -.16551161    .07091618
!       30    -.11729573   -.08442557    .08442557   -.12010992
!       40     .12593642    .00579351   -.00579351    .12608125
!       50    -.09806500    .05679567   -.05679567   -.09692908
!       =========================================================

IMPLICIT DOUBLE PRECISION (a-h,o-z)
WRITE(*,*)'Please enter x'
!        READ(*,*)X
x=50
WRITE(*,20)x
WRITE(*,*)'  x          J0(x)          J0''(X)         J1(X)',  &
    '          J1''(X)'
WRITE(*,*)'------------------------------------------',  &
    '----------------------------'
CALL jy01a(x,bj0,dj0,bj1,dj1,by0,dy0,by1,dy1)
WRITE(*,10)x,bj0,dj0,bj1,dj1
WRITE(*,*)
WRITE(*,*)'  x          Y0(x)          Y0''(X)         Y1(X)',  &
    '          Y1''(X)'
WRITE(*,*)'------------------------------------------',  &
    '----------------------------'
WRITE(*,10)x,by0,dy0,by1,dy1
10      FORMAT(1X,f5.1,4E16.8)
20      FORMAT(3X,'x =',f5.1)
END PROGRAM mjy01a


SUBROUTINE jy01a(x,bj0,dj0,bj1,dj1,by0,dy0,by1,dy1)

!       =======================================================
!       Purpose: Compute Bessel functions J0(x), J1(x), Y0(x),
!                Y1(x), and their derivatives
!       Input :  x   --- Argument of Jn(x) & Yn(x) ( x ò 0 )
!       Output:  BJ0 --- J0(x)
!                DJ0 --- J0'(x)
!                BJ1 --- J1(x)
!                DJ1 --- J1'(x)
!                BY0 --- Y0(x)
!                DY0 --- Y0'(x)
!                BY1 --- Y1(x)
!                DY1 --- Y1'(x)
!       =======================================================


DOUBLE PRECISION, INTENT(IN)             :: x
DOUBLE PRECISION, INTENT(OUT)            :: bj0
DOUBLE PRECISION, INTENT(OUT)            :: dj0
DOUBLE PRECISION, INTENT(OUT)            :: bj1
DOUBLE PRECISION, INTENT(OUT)            :: dj1
DOUBLE PRECISION, INTENT(OUT)            :: by0
DOUBLE PRECISION, INTENT(OUT)            :: dy0
DOUBLE PRECISION, INTENT(OUT)            :: by1
DOUBLE PRECISION, INTENT(OUT)            :: dy1
IMPLICIT DOUBLE PRECISION (a-h,o-z)
DIMENSION a(12),b(12),a1(12),b1(12)

pi=3.141592653589793D0
rp2=0.63661977236758D0
x2=x*x
IF (x == 0.0D0) THEN
  bj0=1.0D0
  bj1=0.0D0
  dj0=0.0D0
  dj1=0.5D0
  by0=-1.0D+300
  by1=-1.0D+300
  dy0=1.0D+300
  dy1=1.0D+300
  RETURN
END IF
IF (x <= 12.0D0) THEN
  bj0=1.0D0
  r=1.0D0
  DO  k=1,30
    r=-0.25D0*r*x2/(k*k)
    bj0=bj0+r
    IF (DABS(r) < DABS(bj0)*1.0D-15) EXIT
  END DO
  10         bj1=1.0D0
  r=1.0D0
  DO  k=1,30
    r=-0.25D0*r*x2/(k*(k+1.0D0))
    bj1=bj1+r
    IF (DABS(r) < DABS(bj1)*1.0D-15) EXIT
  END DO
  20         bj1=0.5D0*x*bj1
  ec=DLOG(x/2.0D0)+0.5772156649015329D0
  cs0=0.0D0
  w0=0.0D0
  r0=1.0D0
  DO  k=1,30
    w0=w0+1.0D0/k
    r0=-0.25D0*r0/(k*k)*x2
    r=r0*w0
    cs0=cs0+r
    IF (DABS(r) < DABS(cs0)*1.0D-15) EXIT
  END DO
  30         by0=rp2*(ec*bj0-cs0)
  cs1=1.0D0
  w1=0.0D0
  r1=1.0D0
  DO  k=1,30
    w1=w1+1.0D0/k
    r1=-0.25D0*r1/(k*(k+1))*x2
    r=r1*(2.0D0*w1+1.0D0/(k+1.0D0))
    cs1=cs1+r
    IF (DABS(r) < DABS(cs1)*1.0D-15) EXIT
  END DO
  40         by1=rp2*(ec*bj1-1.0D0/x-0.25D0*x*cs1)
ELSE
  DATA a/-.7031250000000000D-01,.1121520996093750D+00,  &
      -.5725014209747314D+00,.6074042001273483D+01,  &
      -.1100171402692467D+03,.3038090510922384D+04,  &
      -.1188384262567832D+06,.6252951493434797D+07,  &
      -.4259392165047669D+09,.3646840080706556D+11,  &
      -.3833534661393944D+13,.4854014686852901D+15/
  DATA b/ .7324218750000000D-01,-.2271080017089844D+00,  &
      .1727727502584457D+01,-.2438052969955606D+02,  &
      .5513358961220206D+03,-.1825775547429318D+05,  &
      .8328593040162893D+06,-.5006958953198893D+08,  &
      .3836255180230433D+10,-.3649010818849833D+12,  &
      .4218971570284096D+14,-.5827244631566907D+16/
  DATA a1/.1171875000000000D+00,-.1441955566406250D+00,  &
      .6765925884246826D+00,-.6883914268109947D+01,  &
      .1215978918765359D+03,-.3302272294480852D+04,  &
      .1276412726461746D+06,-.6656367718817688D+07,  &
      .4502786003050393D+09,-.3833857520742790D+11,  &
      .4011838599133198D+13,-.5060568503314727D+15/
  DATA b1/-.1025390625000000D+00,.2775764465332031D+00,  &
      -.1993531733751297D+01,.2724882731126854D+02,  &
      -.6038440767050702D+03,.1971837591223663D+05,  &
      -.8902978767070678D+06,.5310411010968522D+08,  &
      -.4043620325107754D+10,.3827011346598605D+12,  &
      -.4406481417852278D+14,.6065091351222699D+16/
  k0=12
  IF (x >= 35.0) k0=10
  IF (x >= 50.0) k0=8
  t1=x-0.25D0*pi
  p0=1.0D0
  q0=-0.125D0/x
  DO  k=1,k0
    p0=p0+a(k)*x**(-2*k)
    q0=q0+b(k)*x**(-2*k-1)
  END DO
  cu=DSQRT(rp2/x)
  bj0=cu*(p0*DCOS(t1)-q0*DSIN(t1))
  by0=cu*(p0*DSIN(t1)+q0*DCOS(t1))
  t2=x-0.75D0*pi
  p1=1.0D0
  q1=0.375D0/x
  DO  k=1,k0
    p1=p1+a1(k)*x**(-2*k)
    q1=q1+b1(k)*x**(-2*k-1)
  END DO
  cu=DSQRT(rp2/x)
  bj1=cu*(p1*DCOS(t2)-q1*DSIN(t2))
  by1=cu*(p1*DSIN(t2)+q1*DCOS(t2))
END IF
dj0=-bj1
dj1=bj0-bj1/x
dy0=-by1
dy1=by0-by1/x
RETURN
END SUBROUTINE jy01a
